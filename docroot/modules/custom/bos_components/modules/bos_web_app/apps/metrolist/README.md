# Boston.gov Metrolist v3

## Overview
The Metrolist app is built using REACT to poplulate the front-end and Webpack as the deploy and build tool to bundle / transpile the code. The back-end data is stored in Drupal and accessed via AJAX/Fetch to an endpoint generated by Drupal views. Furthermnore, Drupal receives its data from Salesforce which is managed by the Department of Neighborhood Development (DnD).

## Getting Started
The Drupal Web Apps are currently dependent on Node.js and either Gulp or Webpack to bundle and transpile the code base. Instructions are below.

#### Node and NPM (node package manager)

[https://nodejs.org] (https://nodejs.org/en)

Cofirm that you have the latest version.

```shell
npm install npm@latest -g
```

#### Gulp and Gulp CLI (command line interface)

```shell
npm install gulp-cli -g
npm install gulp
```


#### Webpack

```shell
npm install --save-dev webpack
```

## Editing / updating source code
The Web Apps file structure has 2 main directories, 'src' and 'dist'. The source files you edit will be in 'src' and the files to be bundled and referenced from the [Web Apps Library](../../bos_web_app.libraries.yml) will be in the `dist` folder.

__*The 'dist' folder's contents should never be edited directly.*__

1. Browse to the project docroot using the command line

```shell
cd <your_local_directory_path>/boston.gov-d8/docroot/modules/custom/bos_components/modules/bos_web_app/<web_app_name>
```

2. Install node packes using npm


```shell
npm install
```

__*Make sure a `package.json` file exists or else npm can't install needed packages / dependencies.*__

3. Start webpack
A default command will start webpack and 'watch' any changed files.

```shell
npm run webpack:default
```

Alterntively, if you don't want to 'watch' changed files you can just run the 'prod' option after edting neccesary files in step 4.

```shell
npm run webpack:default:prod
```

4. Edit relevant files found in 'src' directory

=== Build locally using docker container =====
to login to container from a terminal
docker exec -it boston_node_1 /bin/bash

cd /app

.. if container has been rebuilt run this block
npm install npm@latest -g
pm install gulp-cli -g
npm install gulp
npm install --save-dev webpack
npm install

cd /app/web_apps/metrolist
npm install

.. to build the metrolist react component
npm run webpack:default:prod
